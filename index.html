<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title> dbTest Client</title>
    <link rel="stylesheet" type="text/css" href="mystyle.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<body>
    <div>
        ID: <input type="text" id="txtId" /> QNT: <input type="text" id="txtNewQuant" /> <input type="button" value="Read one by id" onclick="findById();" />
        <input type="button" value="Add new client" onclick="insertId();" />
        <input type="button" value="Update client" onclick="updateId();" />
        <input type="button" value="Read all" onclick="findAll();" />

    </div>
    <script>
        function findAll() {
           
            $.ajax( {
                url: "api/clienti/GetAllClients",

                type: "GET",
                contentType: "application/json",
                data: "",
                success: function (result) {
                    alert(result);
                },
                error: function (xhr, status, p3, p4) {
                    var err = "Error " + " " + status + " " + p3;
                    if (xhr.responseText && xhr.responseText[0] == "{")
                        err = JSON.parse(xhr.responseText).message;
                    alert(err);
                }
            });
        }
        

        function findById() {
            var id = $('#txtId').val();
            $.ajax({
                url: "api/clienti/GetClient/" + id,
                // url: "api/OrdiniId/GetCustOrders?name=" + name, 
                // se param stringa
                type: "GET",
                contentType: "application/json",
                data: "",
                success: function (result) {
                    alert(result);
                },
                error: function (xhr, status, p3, p4) {
                    var err = "Error " + " " + status + " " + p3;
                    if (xhr.responseText && xhr.responseText[0] == "{")
                        err = JSON.parse(xhr.responseText).message;
                    alert(err);
                }
            });
        }

        function insertId() {
            var id = $('#txtId').val();
            var quant = $('#txtNewQuant').val();
            var options = {};
            options.url = "/api/Clienti/insertCustomer";
            options.type = "POST";
            options.data = JSON.stringify({
                "id": id,
                "req": quant,
                "mag": -1
            });
            options.dataType = "json";
            options.contentType = "application/json";
            options.success = function (msg) {
                alert(msg);
            };
            options.error = function (err) {
                alert(err.statusText
                );
            };
            $.ajax(options);
        }

        function updateId() {
            var options = {};
            options.url = "/api/Clienti/updateCustomer";
            options.type = "PUT";
            options.data = JSON.stringify({
                "id": $("#txtId").val(),
                "req": $('#txtNewQuant').val()
            });
            options.dataType = "json";
            options.contentType = "application/json";
            options.success = function (msg) { alert(msg); };
            options.error = function (err) {
                alert(err.statusText
                );
            };
            $.ajax(options);
        };
    </script>
</body>
</html>